{
"enable_pipeline_locking":
false
,
"group":
"bah"
,
"label_template":
"${COUNT}"
,
"materials":
[
 {
      "url": "https://github.com/tomzo/gocd-json-config-example.git",
      "type": "git",
      "name" : "mygit",
      "destination" : "mydest"
    }
]
,
"environment_variables":
[
]
,
"stages":
[
{
"clean_working_directory":
false
,
"name":
"Build"
,
"fetch_materials":
true
,
"never_cleanup_artifacts":
false
,
"environment_variables":
[
]
,
"approval":
{
"type":
"success"
}
,
"jobs":
[
{
"tasks":
[
{
"working_directory":
"b10_0_0"
,
"type":
"exec"
,
"command":
"xcopy"
,
"run_if":
"passed"
,
"arguments":
[
"..\\ContinuousIntegration\\*"
,
"QA\\ContinuousIntegration\\"
,
"/y"
,
"/s"
,
"/i"
]
}
,
{
"configuration":
[
{
"key":
"script"
,
"value":
"cd %BRANCH_NAME%\\QA\\ContinuousIntegration

python go_cintia.py --firstrevision %GO_FROM_REVISION_PLATFORMCODE% --lastrevision %GO_TO_REVISION_PLATFORMCODE% --goconsolelink http://%GO_SERVER%/go/files/%GO_PIPELINE_NAME%/%GO_PIPELINE_COUNTER%/%GO_STAGE_NAME%/%GO_STAGE_COUNTER%/%GO_JOB_NAME%/cruise-output/console.log --buildospupdater"
}
]
,
"type":
"plugin"
,
"run_if":
"passed"
,
"plugin_configuration":
{
"version":
"1"
,
"id":
"script-executor"
}
}
]
,
"name":
"Build"
,
"tabs":
[
]
,
"artifacts":
[
]
,
"environment_variables":
[
]
,
"resources":
[
"CintiaMachine"
]
}
]
}
,
{
"clean_working_directory":
false
,
"name":
"PublishBuildToS3"
,
"fetch_materials":
false
,
"never_cleanup_artifacts":
false
,
"environment_variables":
[
]
,
"approval":
{
"type":
"success"
}
,
"jobs":
[
{
"tasks":
[
{
"configuration":
[
{
"key":
"script"
,
"value":
"if exist LastBuild rmdir LastBuild /s /q"
}
]
,
"type":
"plugin"
,
"run_if":
"passed"
,
"plugin_configuration":
{
"version":
"1"
,
"id":
"script-executor"
}
}
,
{
"working_directory":
"b10_0_0"
,
"type":
"exec"
,
"command":
"cmd"
,
"run_if":
"passed"
,
"arguments":
[
"/c"
,
"xcopy"
,
"Build%GO_REVISION_PLATFORMCODE%\\*"
,
"LastBuild"
,
"/Y"
,
"/s"
,
"/i"
]
}
,
{
"working_directory":
"b10_0_0"
,
"type":
"exec"
,
"command":
"cmd.exe"
,
"run_if":
"passed"
,
"arguments":
[
"/C"
,
"7z"
,
"a"
,
"-mx=1"
,
"Build%GO_REVISION_PLATFORMCODE%.7z"
,
".\\Build%GO_REVISION_PLATFORMCODE%\\*"
]
}
,
{
"working_directory":
"b10_0_0"
,
"type":
"exec"
,
"command":
"cmd.exe"
,
"run_if":
"passed"
,
"arguments":
[
"/C"
,
"aws"
,
"s3"
,
"cp"
,
"Build%GO_REVISION_PLATFORMCODE%.7z"
,
"s3://%GO_ARTIFACTS_S3_BUCKET%/%GO_PIPELINE_NAME%/%GO_PIPELINE_COUNTER%/%GO_STAGE_NAME%/%GO_STAGE_COUNTER%/Build.7z"
]
}
,
{
"working_directory":
"b10_0_0"
,
"type":
"exec"
,
"command":
"cmd.exe"
,
"run_if":
"passed"
,
"arguments":
[
"/C"
,
"del"
,
"Build%GO_REVISION_PLATFORMCODE%.7z"
]
}
,
{
"working_directory":
"b10_0_0"
,
"type":
"exec"
,
"command":
"cmd"
,
"run_if":
"passed"
,
"arguments":
[
"/c"
,
"rmdir"
,
"Build%GO_REVISION_PLATFORMCODE%"
,
"/s"
,
"/q"
]
}
,
{
"configuration":
[
{
"key":
"script"
,
"value":
"ECHO %GO_REVISION_PLATFORMCODE% >platform_revision.txt"
}
]
,
"type":
"plugin"
,
"run_if":
"passed"
,
"plugin_configuration":
{
"version":
"1"
,
"id":
"script-executor"
}
}
]
,
"name":
"PublishBuildToS3"
,
"tabs":
[
]
,
"artifacts":
[
{
"source":
"platform_revision.txt"
,
"destination":
""
,
"type":
"build"
}
]
,
"environment_variables":
[
]
,
"resources":
[
"CintiaMachine"
]
}
]
}
]
,
"name":
"Test212354"
}
